<!--pages/wrong-questions/wrong-questions.wxml - é”™é¢˜æ™ºèƒ½åˆ†æé¡µé¢-->
<view class="page-container">
  
  <!-- â‘  é¡¶éƒ¨æ ‡é¢˜åŒºï¼ˆå±…ä¸­ï¼‰ -->
  <view class="page-header-simple">
    <text class="header-title-center">é”™é¢˜æ™ºèƒ½åˆ†æ</text>
  </view>

  <!-- â‘¡ Tabåˆ‡æ¢æ  -->
  <view class="tab-section">
    <view class="tab-bar">
      <view 
        class="tab-item {{activeTab === 'all' ? 'tab-active' : ''}}"
        bindtap="switchTab"
        data-tab="all"
      >
        <text class="tab-text">å…¨éƒ¨</text>
        <text class="tab-count">({{stats.total}})</text>
      </view>
      <view 
        class="tab-item {{activeTab === 'unreviewed' ? 'tab-active' : ''}}"
        bindtap="switchTab"
        data-tab="unreviewed"
      >
        <text class="tab-text">å¾…å¤ä¹ </text>
        <text class="tab-count">({{stats.unreviewed}})</text>
      </view>
      <view 
        class="tab-item {{activeTab === 'reviewed' ? 'tab-active' : ''}}"
        bindtap="switchTab"
        data-tab="reviewed"
      >
        <text class="tab-text">å·²å¤ä¹ </text>
        <text class="tab-count">({{stats.reviewed}})</text>
      </view>
      <view 
        class="tab-item {{activeTab === 'weak' ? 'tab-active' : ''}}"
        bindtap="switchTab"
        data-tab="weak"
      >
        <text class="tab-text">è–„å¼±ç‚¹</text>
        <text class="tab-count">({{weakPoints.length}})</text>
      </view>
    </view>
  </view>

  <!-- â‘¢ ä¸»å†…å®¹åŒº - æ ¹æ®Tabæ˜¾ç¤ºä¸åŒå†…å®¹ -->
  <view class="content-area">
    
    <!-- â­ è–„å¼±ç‚¹Tabå†…å®¹ - ä¼˜åŒ–å -->
    <view wx:if="{{activeTab === 'weak' && weakPoints.length > 0}}" class="weak-points-card">
      <view class="weak-card-header">
        <text class="weak-card-title">è–„å¼±ç‚¹è¯Šæ–­</text>
        <text class="weak-card-desc">åŸºäºé”™é¢˜æ•°æ®åˆ†æï¼Œç³»ç»Ÿä¸ºä½ è¯†åˆ«å‡º {{weakPoints.length}} ä¸ªä¸»è¦è–„å¼±ç¯èŠ‚</text>
      </view>
      <view class="weak-badges-grid">
        <view wx:for="{{weakPoints}}" wx:key="type" class="weak-badge-item">
          <view class="weak-badge-rank">#{{index + 1}}</view>
          <view class="weak-badge-info">
            <text class="weak-badge-name">{{item.typeName}}</text>
            <view class="weak-badge-stats">
              <text class="weak-badge-count">{{item.count}}é¢˜</text>
              <text class="weak-badge-percent">{{item.percentage}}%</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- â­ é”™é¢˜åˆ—è¡¨ï¼ˆå…¨éƒ¨/å¾…å¤ä¹ /å·²å¤ä¹ Tabï¼‰ -->
    <view wx:if="{{activeTab !== 'weak'}}" class="questions-list-section">
      <view class="section-header-simple">
        <text class="section-title-simple">é”™é¢˜åˆ—è¡¨</text>
        <text class="section-count-simple">{{filteredQuestions.length}}é¢˜</text>
      </view>

      <!-- é”™é¢˜å¡ç‰‡åˆ—è¡¨ -->
      <view class="questions-list">
        <view wx:for="{{filteredQuestions}}" wx:key="id" class="question-card-item" bindtap="goToQuestionDetail" data-id="{{item.id}}">
          <view class="question-header-row">
            <view class="question-type-tag">{{item.typeName}}</view>
            <text class="question-date">{{item.date}}</text>
          </view>
          <text class="question-content-preview">{{item.content}}</text>
          <view class="question-footer-row">
            <view class="question-status">
              <image wx:if="{{item.reviewed}}" src="/images/check.png" class="status-icon" mode="aspectFit"/>
              <text class="status-text">{{item.reviewed ? 'å·²å¤ä¹ ' : 'å¾…å¤ä¹ '}}</text>
            </view>
            <image src="/images/chevron-right.png" class="question-arrow" mode="aspectFit"/>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ - ä½¿ç”¨empty-stateç»„ä»¶ -->
      <empty-state
        wx:if="{{filteredQuestions.length === 0}}"
        icon="ğŸ˜Š"
        title="æš‚æ— é”™é¢˜"
        description="ç»§ç»­åŠªåŠ›ï¼Œä¿æŒè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼"
        buttonText="å»ç»ƒä¹ "
        bind:buttontap="goToQuizBank"
      />
    </view>

    <!-- ä¸ªæ€§åŒ–è®­ç»ƒè®¡åˆ’ï¼ˆä»…è–„å¼±ç‚¹Tabæ˜¾ç¤ºï¼‰ - ä¼˜åŒ–å -->
    <view wx:if="{{activeTab === 'weak'}}" class="training-section">
      <view class="training-header">
        <text class="training-title">ä¸ªæ€§åŒ–è®­ç»ƒè®¡åˆ’</text>
        <text class="training-count">{{trainingPlans.length}}ä¸ªè®¡åˆ’</text>
      </view>

      <!-- æ— è®¡åˆ’çŠ¶æ€ - ä½¿ç”¨empty-stateç»„ä»¶ -->
      <empty-state
        wx:if="{{trainingPlans.length === 0}}"
        icon="ğŸ“"
        title="æš‚æ— è®­ç»ƒè®¡åˆ’"
        description="å®Œæˆä¸€äº›ç»ƒä¹ åï¼Œç³»ç»Ÿå°†ä¸ºä½ ç”Ÿæˆä¸ªæ€§åŒ–è®­ç»ƒæ–¹æ¡ˆ"
        buttonText="å¼€å§‹ç»ƒä¹ "
        bind:buttontap="goToQuizBank"
      />

      <!-- è®­ç»ƒè®¡åˆ’åˆ—è¡¨ - ä¼˜åŒ–å¸ƒå±€ -->
      <view wx:else class="training-plans-grid">
        <view 
          wx:for="{{trainingPlans}}" 
          wx:key="type"
          class="training-plan-card"
          bindtap="startTraining"
          data-type="{{item.type}}"
        >
          <!-- é¡¶éƒ¨è£…é¥°æ¡ -->
          <view class="plan-accent plan-accent-{{item.type}}"></view>
          
          <!-- å¡ç‰‡å†…å®¹ -->
          <view class="plan-body">
            <!-- å¤´éƒ¨ï¼šç±»å‹ + åºå· -->
            <view class="plan-top">
              <view class="plan-type-badge badge-{{item.type}}">
                <text class="plan-type-text">{{item.typeName}}</text>
                <text wx:if="{{item.difficulty === 'é‡ç‚¹'}}" class="plan-priority">é‡ç‚¹</text>
              </view>
              <view class="plan-index">{{index + 1}}</view>
            </view>

            <!-- æ ‡é¢˜å’Œæè¿° -->
            <view class="plan-main">
              <text class="plan-name">{{item.title}}</text>
              <text class="plan-desc">{{item.description}}</text>
            </view>

            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <view class="plan-metrics">
              <view class="plan-metric">
                <text class="metric-label">ç»ƒä¹ </text>
                <text class="metric-value">{{item.exercises}}é¢˜</text>
              </view>
              <view class="plan-metric-divider"></view>
              <view class="plan-metric">
                <text class="metric-label">ç”¨æ—¶</text>
                <text class="metric-value">{{item.duration}}</text>
              </view>
            </view>

            <!-- å¼€å§‹æŒ‰é’® -->
            <view class="plan-start-btn">
              <text class="start-btn-text">å¼€å§‹è®­ç»ƒ</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- AI æ™ºèƒ½å»ºè®®ï¼ˆä»…è–„å¼±ç‚¹Tabæ˜¾ç¤ºï¼‰ - ä¼˜åŒ–å -->
    <view wx:if="{{activeTab === 'weak' && trainingPlans.length > 0}}" class="ai-tips-card">
      <view class="ai-tips-header">
        <text class="ai-tips-title">AI æ™ºèƒ½å»ºè®®</text>
      </view>
      <view class="ai-tips-list">
        <view class="ai-tip-item">
          <text class="ai-tip-text">å»ºè®®æ¯å¤©å®Œæˆ 1-2 ä¸ªè®­ç»ƒè®¡åˆ’ï¼Œå¾ªåºæ¸è¿›</text>
        </view>
        <view class="ai-tip-item">
          <text class="ai-tip-text">ä¼˜å…ˆæ”»å…‹"{{trainingPlans[0].typeName}}"æ¨¡å—ï¼Œè¿™æ˜¯ä½ ç›®å‰æœ€è–„å¼±çš„ç¯èŠ‚</text>
        </view>
        <view class="ai-tip-item">
          <text class="ai-tip-text">å¤ä¹ å·²æŒæ¡çš„é”™é¢˜ï¼Œå·©å›ºè®°å¿†æ•ˆæœæ›´ä½³</text>
        </view>
      </view>
    </view>

  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒº -->
  <view class="bottom-spacer"></view>

</view>
