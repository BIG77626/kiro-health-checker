<!--pages/profile/profile.wxml-->
<view class="profile-page">
  <!-- Header with Gradient Background -->
  <view class="profile-header-new">
    <view class="header-inner-wrapper" wx:if="{{hasLogin}}">
      <!-- Large Avatar -->
      <view class="avatar-large">
        <text class="avatar-letter">{{userInfo.nickName ? userInfo.nickName.charAt(0).toUpperCase() : 'C'}}</text>
      </view>
      
      <!-- User Name -->
      <text class="user-name-large">{{userInfo.nickName || 'User'}}</text>
      
      <!-- Email -->
      <text class="user-email-text">{{userInfo.email || 'user@example.com'}}</text>
    </view>
    
    <!-- Not Logged In -->
    <view class="header-inner-wrapper" wx:else>
      <view class="avatar-large">
        <text class="avatar-letter">?</text>
      </view>
      <text class="user-name-large">æœªç™»å½•</text>
      <text class="user-email-text">ç™»å½•åå¯æŸ¥çœ‹å­¦ä¹ æ•°æ®</text>
    </view>
  </view>
  
  <!-- 3 White Stats Cards - Overlapping Header -->
  <view class="stats-overlap-container">
    <view class="stat-mini-card">
      <view class="icon-circle-bg orange-bg">
        <text class="icon-emoji">ğŸ”¥</text>
      </view>
      <text class="stat-big-number">{{studyDays || 3}}</text>
      <text class="stat-gray-label">å­¦ä¹ å¤©æ•°</text>
    </view>
    
    <view class="stat-mini-card">
      <view class="icon-circle-bg blue-bg">
        <text class="icon-emoji">ğŸ†</text>
      </view>
      <text class="stat-big-number">{{achievements.totalStudyTime || 225}}</text>
      <text class="stat-gray-label">ç´¯è®¡åˆ†é’Ÿ</text>
    </view>
    
    <view class="stat-mini-card">
      <view class="icon-circle-bg green-bg">
        <text class="icon-emoji">ğŸ¯</text>
      </view>
      <text class="stat-big-number">{{achievements.totalQuestions || 3}}</text>
      <text class="stat-gray-label">æŒæ¡è¯æ±‡</text>
    </view>
  </view>

  <!-- Main Content -->
  <view class="main-content">
    <!-- Learning Overview Purple Card -->
    <view class="learning-overview-purple">
      <text class="overview-title">å­¦ä¹ æ¦‚è§ˆ</text>
      <view class="overview-data-row">
        <view class="overview-col">
          <text class="overview-label-small">å®Œæˆç›®æ ‡</text>
          <text class="overview-value-large">{{achievements.totalQuestions || 119}}</text>
        </view>
        <view class="overview-col">
          <text class="overview-label-small">æ­£ç¡®ç‡</text>
          <text class="overview-value-large">{{achievements.bestAccuracy || 87}}%</text>
        </view>
      </view>
    </view>

    <!-- Menu List -->
    <view class="menu-section">
      <view class="menu-card">
        <view class="menu-item" bindtap="goToStudySettings">
          <image src="/images/settings.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">å­¦ä¹ è®¾ç½®</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="goToStudyHistory">
          <image src="/images/history.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">å­¦ä¹ è®°å½•</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="goToFeedback">
          <image src="/images/message.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">æ„è§åé¦ˆ</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="editUserInfo" wx:if="{{hasLogin}}">
          <image src="/images/profile.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">ç¼–è¾‘èµ„æ–™</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="clearCache">
          <image src="/images/refresh.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">æ¸…é™¤ç¼“å­˜</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item" bindtap="showAbout">
          <image src="/images/info.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text">å…³äºæˆ‘ä»¬</text>
          <text class="menu-arrow">â€º</text>
        </view>
        
        <view class="menu-item logout-item" bindtap="handleLogout" wx:if="{{hasLogin}}">
          <image src="/images/logout.png" class="menu-icon" mode="aspectFit"></image>
          <text class="menu-text logout-text">é€€å‡ºç™»å½•</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
  <view class="text-center text-caption color-tertiary section-spacing">
    <text>è€ƒç ”åˆ·é¢˜å°ç¨‹åº v{{version}}</text>
  </view>
</view>

<!-- é¦–æ¬¡ä¸»é¢˜è®¾ç½®å¼¹çª— -->
<first-time-setup 
  visible="{{showThemeSetup}}"
  system-theme="{{systemTheme}}"
  bind:confirm="onThemeSetupConfirm"
  bind:close="onThemeSetupClose"
/>

<!-- å…³äºæˆ‘ä»¬å¼¹çª— -->
  <view wx:if="{{showAboutModal}}" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 z-50 flex items-center justify-center" bindtap="hideAbout">
    <view class="profile-card max-w-sm" catchtap="">
      <view class="align-center mb-4">
        <image src="/images/info.png" class="icon-lg mb-3" mode="aspectFit"></image>
        <text class="text-title">å…³äºæˆ‘ä»¬</text>
        <text class="text-caption color-tertiary mt-1">è€ƒç ”åˆ·é¢˜å°ç¨‹åº v{{version}}</text>
      </view>
      <view class="text-body mb-6">
        <text>è€ƒç ”åˆ·é¢˜å°ç¨‹åºæ˜¯ä¸€æ¬¾ä¸“ä¸ºè€ƒç ”å­¦å­æ‰“é€ çš„é«˜æ•ˆå­¦ä¹ å·¥å…·ï¼Œæä¾›å…¨é¢çš„é¢˜ç›®ç»ƒä¹ å’Œæ™ºèƒ½å­¦ä¹ åˆ†æåŠŸèƒ½ã€‚</text>
      </view>
      <view class="align-center">
        <button class="profile-btn profile-btn-primary" bindtap="hideAbout">ç¡®å®š</button>
      </view>
    </view>
  </view>
