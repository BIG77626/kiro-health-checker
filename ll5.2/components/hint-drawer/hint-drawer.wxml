<!-- çŸ­é“¾æ€è€ƒ - æŠ½å±‰å¼è¯¦ç»†æç¤º -->
<block wx:if="{{visible}}">
  <view class="hint-drawer-mask" bindtap="onMaskTap" catchtouchmove="preventMove"></view>
  <view class="hint-drawer {{state}}" catchtap="stopPropagation" catchtouchmove="preventMove"
    
    <!-- é¡¶éƒ¨æ‹–åŠ¨æ¡ -->
    <view class="drag-bar">
      <view class="drag-handle"></view>
    </view>
    
    <!-- æ ‡é¢˜æ  -->
    <view class="drawer-header">
      <text class="header-title">ğŸ’¡ çŸ­é“¾æ€è€ƒæç¤º</text>
      <text class="header-close" bindtap="onClose">âœ•</text>
    </view>
    
    <!-- Step1: ä¸€è¡Œèšç„¦ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰ -->
    <view class="drawer-step step1" wx:if="{{step >= 1}}">
      <view class="step-header">
        <text class="step-tag">Step 1</text>
        <text class="step-label">èšç„¦å…³é”®</text>
      </view>
      <view class="step-content">
        <text class="focus-text">{{step1Text}}</text>
      </view>
    </view>
    
    <!-- Step2: æ€ç»´æ”¯æ¶ï¼ˆéœ€è§£é”ï¼‰ -->
    <view class="drawer-step step2" wx:if="{{step >= 2}}">
      <view class="step-header">
        <text class="step-tag">Step 2</text>
        <text class="step-label">æ€ç»´æ”¯æ¶</text>
        <text class="step-unlock-badge" wx:if="{{!step2Unlocked}}">ğŸ”’ å·²é”å®š</text>
      </view>
      
      <view class="step-content" wx:if="{{step2Unlocked}}">
        <view class="scaffold-list">
          <view class="scaffold-item" wx:for="{{scaffoldSteps}}" wx:key="index">
            <text class="scaffold-index">{{index + 1}}.</text>
            <text class="scaffold-text">{{item}}</text>
          </view>
        </view>
      </view>
      
      <!-- è§£é”æŒ‰é’® -->
      <view class="unlock-gate" wx:if="{{!step2Unlocked}}">
        <text class="gate-hint">{{gateHintStep2}}</text>
        <button 
          class="unlock-btn {{gateReadyStep2 ? 'ready' : 'disabled'}}" 
          bindtap="onUnlockStep2"
          disabled="{{!gateReadyStep2}}">
          {{gateReadyStep2 ? 'ç«‹å³æŸ¥çœ‹' : 'è§£é”ä¸­...'}}
        </button>
      </view>
    </view>
    
    <!-- Step3: è‡ªæ£€æ¸…å•ï¼ˆéœ€è§£é”ï¼‰ -->
    <view class="drawer-step step3" wx:if="{{step >= 3}}">
      <view class="step-header">
        <text class="step-tag">Step 3</text>
        <text class="step-label">è‡ªæ£€æ¸…å•</text>
        <text class="step-unlock-badge" wx:if="{{!step3Unlocked}}">ğŸ”’ å·²é”å®š</text>
      </view>
      
      <view class="step-content" wx:if="{{step3Unlocked}}">
        <view class="checklist">
          <view class="checklist-item" wx:for="{{checklistItems}}" wx:key="index">
            <text class="checkbox">â˜‘</text>
            <text class="checklist-text">{{item}}</text>
          </view>
        </view>
        
        <!-- å¾®é«˜äº®ææ–™ -->
        <view class="highlight-material" wx:if="{{highlightedText}}">
          <view class="material-label">å…³é”®å¥é«˜äº®ï¼š</view>
          <rich-text class="material-text" nodes="{{highlightedText}}"></rich-text>
        </view>
      </view>
      
      <!-- è§£é”æŒ‰é’® -->
      <view class="unlock-gate" wx:if="{{!step3Unlocked}}">
        <text class="gate-hint">{{gateHintStep3}}</text>
        <button 
          class="unlock-btn {{gateReadyStep3 ? 'ready' : 'disabled'}}" 
          bindtap="onUnlockStep3"
          disabled="{{!gateReadyStep3}}">
          {{gateReadyStep3 ? 'ç«‹å³æŸ¥çœ‹' : 'è§£é”ä¸­...'}}
        </button>
      </view>
    </view>
    
    <!-- åº•éƒ¨ç¡®è®¤æŒ‰é’® -->
    <view class="drawer-footer" wx:if="{{step3Unlocked}}">
      <button class="confirm-btn" bindtap="onConfirm">
        æˆ‘æ˜ç™½äº†ï¼Œç»§ç»­ç­”é¢˜
      </button>
    </view>
    
  </view>
</block>

